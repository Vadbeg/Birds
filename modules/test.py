import torch
import torch.nn.functional as F

if __name__ == '__main__':
    LENGTH = 264

    res = [0.0207, 0.0163, 0.1684, 0.0263, 0.3576, 0.4302, 0.0230, 0.9501, 0.0728,
           0.0390, 0.0186, 0.0184, 0.0280, 0.0184, 0.0478, 0.0300, 0.0210, 0.0179,
           0.0298, 0.0159, 0.0660, 0.0498, 0.8348, 0.0650, 0.1358, 0.0175, 0.0194,
           0.0304, 0.0341, 0.0185, 0.0301, 0.6693, 0.0267, 0.3774, 0.7456, 0.0459,
           0.7967, 0.0212, 0.1500, 0.0240, 0.0148, 0.0985, 0.0493, 0.0176, 0.0287,
           0.9109, 0.0195, 0.1275, 0.0143, 0.0181, 0.3212, 0.0222, 0.0220, 0.0188,
           0.0222, 0.0523, 0.0419, 0.0205, 0.0204, 0.9618, 0.1466, 0.0317, 0.0356,
           0.5509, 0.0157, 0.0134, 0.0132, 0.0185, 0.0353, 0.0137, 0.0174, 0.0484,
           0.0168, 0.3575, 0.1746, 0.8672, 0.0180, 0.0598, 0.8829, 0.0270, 0.0588,
           0.8174, 0.0239, 0.0197, 0.4379, 0.0261, 0.0330, 0.9573, 0.0436, 0.0164,
           0.1248, 0.8145, 0.0142, 0.0271, 0.0164, 0.5245, 0.0221, 0.9687, 0.0126,
           0.7121, 0.0237, 0.0181, 0.0247, 0.2347, 0.0411, 0.0212, 0.0268, 0.0178,
           0.0179, 0.9395, 0.0353, 0.1417, 0.0296, 0.0372, 0.0326, 0.0295, 0.0166,
           0.0465, 0.0339, 0.0206, 0.0195, 0.9562, 0.7213, 0.6059, 0.0231, 0.0187,
           0.0190, 0.2153, 0.0404, 0.0465, 0.0168, 0.3533, 0.9696, 0.0248, 0.0574,
           0.0137, 0.0181, 0.0461, 0.0244, 0.2458, 0.9068, 0.8912, 0.0156, 0.0332,
           0.0347, 0.0202, 0.0509, 0.8974, 0.0157, 0.0207, 0.0138, 0.3650, 0.0442,
           0.0321, 0.8244, 0.0264, 0.0428, 0.0231, 0.0396, 0.9609, 0.6657, 0.0188,
           0.0159, 0.0199, 0.0454, 0.0214, 0.1132, 0.7233, 0.0191, 0.0273, 0.8118,
           0.1470, 0.9562, 0.0146, 0.1241, 0.0150, 0.8663, 0.4052, 0.0232, 0.0650,
           0.4617, 0.0204, 0.3435, 0.4577, 0.0215, 0.1110, 0.0193, 0.0494, 0.5425,
           0.6958, 0.0289, 0.6415, 0.0344, 0.0404, 0.0260, 0.0378, 0.2102, 0.7333,
           0.6033, 0.2187, 0.0230, 0.0221, 0.0232, 0.0332, 0.9732, 0.0342, 0.9464,
           0.1311, 0.0246, 0.1225, 0.0135, 0.0555, 0.0266, 0.0302, 0.0634, 0.2076,
           0.0329, 0.0167, 0.0344, 0.6711, 0.0238, 0.0162, 0.0250, 0.6538, 0.0172,
           0.3652, 0.7518, 0.0439, 0.4373, 0.0250, 0.0185, 0.6857, 0.0375, 0.0592,
           0.0271, 0.0345, 0.0434, 0.0289, 0.0311, 0.0618, 0.0693, 0.8616, 0.8280,
           0.0540, 0.0450, 0.0417, 0.0494, 0.0131, 0.0131, 0.0257, 0.0535, 0.9808,
           0.8027, 0.0735, 0.2330, 0.0224, 0.9136, 0.1837, 0.9263, 0.2707, 0.0278,
           0.0319, 0.0394, 0.6737]

    y = 238

    res = [0] * LENGTH
    res[y] = 100000

    res = torch.tensor([res])
    y = torch.tensor([y])

    print(res)
    print(y)

    loss_value = F.cross_entropy(res.float(), y)

    print(loss_value)

    torch.nn.CrossEntropyLoss()
